{"version":3,"sources":["js/tagcanvas.js"],"names":["i","j","abs","Math","sin","cos","max","min","ceil","sqrt","pow","hexlookup3","hexlookup2","hexlookup1","a","A","b","B","c","C","d","D","e","E","f","F","Oproto","Tproto","TCproto","Mproto","Vproto","TSproto","TCVproto","doc","document","ocanvas","handlers","toString","toUpperCase","Defined","IsObject","o","Clamp","v","mn","mx","isNaN","Nop","TimeNow","Date","valueOf","SortList","l","nl","tl","length","push","sort","Shuffle","t","p","random","Vector","x","y","z","prototype","dot","cross","angle","ac","PI","acos","unit","MakeVector","lg","lt","Matrix","Identity","Rotation","u","sina","cosa","mcos","mul","m","mmatrix","xform","PointsOnSphere","n","xr","yr","zr","r","phi","pts","inc","off","Cylinder","k","Ring","PointsOnCylinderV","PointsOnCylinderH","PointsOnRingV","offset","PointsOnRingH","CentreImage","Image","onload","dx","width","dy","height","centreFunc","w","h","cx","cy","setTransform","globalAlpha","drawImage","src","centreImage","SetAlpha","p1","p2","ae","toPrecision","substr","replace","lastIndexOf","indexOf","parseFloat","substring","NewCanvas","window","G_vmlCanvasManager","createElement","ShadowAlphaBroken","cv","getContext","strokeStyle","shadowColor","shadowBlur","strokeRect","getImageData","data","SetGradient","g","gd","createLinearGradient","addColorStop","fillStyle","fillRect","FindGradientColour","tc","gl","weightGradient","gCanvas","TextSet","ctxt","font","colour","strings","padx","pady","shadowColour","shadowOffsets","maxWidth","widths","align","xo","yo","xc","textBaseline","shadowOffsetX","shadowOffsetY","fillText","parseInt","RRect","s","beginPath","moveTo","arcTo","closePath","TextCanvas","stringWidths","valign","scale","SetImage","image","position","padding","iwidth","iheight","ipos","ipad","iscale","ialign","ivalign","Align","size","space","pos","Create","bgColour","bgOutline","bgOutlineThickness","radius","cw","ch","x1","x2","y1","y2","offx","offy","ix","iy","iw","ih","sox","soy","shadowcv","shadowc","lineWidth","ExpandImage","ScaleImage","AddBackgroundToImage","othickness","ocolour","ofill","cc","globalCompositeOperation","AddShadowToImage","sc","sb","so","sw","sh","FindTextBoundingBox","ht","idata","w1","h1","ex","FixFont","AddHandler","addEventListener","attachEvent","RemoveHandler","removeEventListener","detachEvent","AddImage","imageScale","mscale","ic","bc","oc","complete","txtOpt","zoomMax","txtScale","naturalWidth","naturalHeight","fimage","HasText","shadow","shadowOffset","GetProperty","textColour","outlineMethod","outlineColour","bgRadius","oimage","outlineIncrease","Init","dv","defaultView","pc","charAt","getComputedStyle","getPropertyValue","currentStyle","FindWeight","wFrom","tHeight","getAttribute","EventToCanvasId","target","id","srcElement","parentNode","EventXY","xy","xmul","ymul","offsetX","offsetY","AbsPos","changedTouches","pageX","pageY","MouseOut","fromElement","TagCanvas","my","UnFreeze","EndDrag","MouseMove","tg","tttimer","clearTimeout","canvas","Drag","drawn","MouseDown","cb","button","BeginDrag","MouseUp","touchState","Clicked","TouchDown","touches","targetTouches","pinchZoom","BeginPinch","EndPinch","TouchUp","Draw","TouchMove","Pinch","MouseWheel","cancelBubble","returnValue","preventDefault","Wheel","wheelDelta","detail","DrawCanvas","DrawCanvasRAF","NextFrame","interval","getElementById","getBoundingClientRect","dd","documentElement","body","xs","pageXOffset","scrollLeft","ys","pageYOffset","scrollTop","clientLeft","clientTop","left","top","Project","sx","sy","z1","z2","TextSplitter","br","line","text","original","innerText","textContent","Empty","Lines","cn","cl","childNodes","nodeName","join","nodeType","nodeValue","SplitWidth","words","split","measureText","Outline","ts","tag","pulsateTo","DrawPulsate","DrawSimple","outlineRadius","SetMethod","om","methods","block","outline","classic","none","funcs","drawFunc","Update","outlineOffset","o2","DrawOutline","DrawColour","alpha","DrawColourText","normal","DrawColourImage","ccanvas","fx","fy","fw","fh","clearRect","save","rect","clip","restore","DrawBlock","outlineThickness","diff","pulsateTime","Active","PreDraw","PostDraw","LastDraw","Tag","col","bcol","bradius","boutline","bothickness","text_original","line_widths","title","textFont","weighted","weight","textHeight","Measure","SetShadowColour","shadowAlpha","SetShadowColourAlpha","SetShadowColourFixed","SetDraw","EqualTo","getElementsByTagName","href","ie","DrawImageIE","DrawImage","DrawText","noSelect","CheckActive","MeasureText","wl","extents","th","soff","twidth","theight","img","tcv","textAlign","textVAlign","imagePosition","imagePadding","imageAlign","imageVAlign","SetFont","boc","SetWeight","modes","weightMode","Weight","min_weight","max_weight","wmin","wmax","wnum","nweight","weightSizeMin","weightSizeMax","weightSize","xoff","yoff","xl","im","Calc","pp","mnb","minBrightness","mxb","maxBrightness","max_radius","xformed","stretchX","stretchY","UpdateActive","evt","self","frames","location","err","open","createEvent","initMouseEvent","dispatchEvent","fireEvent","cid","lctr","opt","cp","raf","initElement","navigator","appVersion","insertBefore","removeChild","options","depth","zoom","lx","lock","ly","frozen","fixedAnim","fixedAlpha","source","repeatTags","minTags","GetTags","transform","startTime","time","Animate","dragControl","AnimateDrag","AnimatePosition","animTiming","Smooth","Load","hideTags","loaded","HideTags","yaw","initial","maxSpeed","pitch","tooltip","ctitle","Tooltip","TooltipNative","TooltipDiv","ttdiv","className","tooltipClass","style","zIndex","display","appendChild","TooltipNone","noMouse","wheelZoom","started","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","NextFrameRAF","NextFrameTimeout","SourceElements","querySelectorAll","el","etl","Message","CreateTag","txt","imageMode","splitWidth","UpdateTag","ll","weights","valid","wfrom","weightFrom","taglist","shape","shapeArgs","rx","ry","rz","vl","tagmap","pfuncs","sphere","vcylinder","hcylinder","vring","hring","shuffleTags","radiusX","radiusY","radiusZ","shift","concat","apply","listLength","noTagsMessage","newlist","found","added","removed","ol","splice","pop","SetShadow","paused","max_sc","tdelta","active","aindex","frontsel","frontSelect","centreDrawn","fixed","AnimateFixed","alert","freezeActive","Freeze","fixedCallback","fixedCallbackTag","cursor","activeCursor","SetTTDiv","innerHTML","setTimeout","tooltipDelay","Transform","sp","ym","pm","fa","t1","fadeIn","t0","axis","reverse","freezeDecel","Decel","rs","preFreeze","minSpeed","ay","ap","z0","decel","Zoom","clickToFront","TagToFront","zoomStep","zoomMin","down","t2","dragThreshold","dragging","res","PinchDistance","pinched","Pause","Resume","SetSpeed","FindTag","index","srch","tgt","RotateTag","callback","v1","v2","Start","Delete","tccall","Linear","Reload","speed","lat","lng","tt","iv"],"mappings":"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","file":"tagcanvas.b65b502a.map","sourceRoot":"..","sourcesContent":["/**\n * Copyright (C) 2010-2015 Graham Breach\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n * \n * You should have received a copy of the GNU Lesser General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * TagCanvas 2.7\n * For more information, please contact <graham@goat1000.com>\n */\n(function(){\n\"use strict\";\nvar i, j, abs = Math.abs, sin = Math.sin, cos = Math.cos, max = Math.max,\n  min = Math.min, ceil = Math.ceil, sqrt = Math.sqrt, pow = Math.pow,\n  hexlookup3 = {}, hexlookup2 = {}, hexlookup1 = {\n  0:\"0,\",   1:\"17,\",  2:\"34,\",  3:\"51,\",  4:\"68,\",  5:\"85,\",\n  6:\"102,\", 7:\"119,\", 8:\"136,\", 9:\"153,\", a:\"170,\", A:\"170,\",\n  b:\"187,\", B:\"187,\", c:\"204,\", C:\"204,\", d:\"221,\", D:\"221,\",\n  e:\"238,\", E:\"238,\", f:\"255,\", F:\"255,\"  \n  }, Oproto, Tproto, TCproto, Mproto, Vproto, TSproto, TCVproto,\n  doc = document, ocanvas, handlers = {};\nfor(i = 0; i < 256; ++i) {\n  j = i.toString(16);\n  if(i < 16)\n    j = '0' + j;\n  hexlookup2[j] = hexlookup2[j.toUpperCase()] = i.toString() + ',';\n}\nfunction Defined(d) {\n  return typeof d != 'undefined';\n}\nfunction IsObject(o) {\n  return typeof o == 'object' && o != null;\n}\nfunction Clamp(v, mn, mx) {\n  return isNaN(v) ? mx : min(mx, max(mn, v));\n}\nfunction Nop() {\n  return false;\n}\nfunction TimeNow() {\n  return new Date().valueOf();\n}\nfunction SortList(l, f) {\n  var nl = [], tl = l.length, i;\n  for(i = 0; i < tl; ++i)\n    nl.push(l[i]);\n  nl.sort(f);\n  return nl;\n}\nfunction Shuffle(a) {\n  var i = a.length-1, t, p;\n  while(i) {\n    p = ~~(Math.random()*i);\n    t = a[i];\n    a[i] = a[p];\n    a[p] = t;\n    --i;\n  }\n}\nfunction Vector(x, y, z) {\n  this.x = x;\n  this.y = y;\n  this.z = z;\n}\nVproto = Vector.prototype;\nVproto.length = function() {\n  return sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n};\nVproto.dot = function(v) {\n  return this.x * v.x + this.y * v.y + this.z * v.z;\n};\nVproto.cross = function(v) {\n  var x = this.y * v.z - this.z * v.y,\n    y = this.z * v.x - this.x * v.z,\n    z = this.x * v.y - this.y * v.x;\n  return new Vector(x, y, z);\n};\nVproto.angle = function(v) {\n  var dot = this.dot(v), ac;\n  if(dot == 0)\n    return Math.PI / 2.0;\n  ac = dot / (this.length() * v.length());\n  if(ac >= 1)\n    return 0;\n  if(ac <= -1)\n    return Math.PI;\n  return Math.acos(ac);\n};\nVproto.unit = function() {\n  var l = this.length();\n  return new Vector(this.x / l, this.y / l, this.z / l);\n};\nfunction MakeVector(lg, lt) {\n  lt = lt * Math.PI / 180;\n  lg = lg * Math.PI / 180;\n  var x = sin(lg) * cos(lt), y = -sin(lt), z = -cos(lg) * cos(lt);\n  return new Vector(x, y, z);\n}\nfunction Matrix(a) {\n  this[1] = {1: a[0],  2: a[1],  3: a[2]};\n  this[2] = {1: a[3],  2: a[4],  3: a[5]};\n  this[3] = {1: a[6],  2: a[7],  3: a[8]};\n}\nMproto = Matrix.prototype;\nMatrix.Identity = function() {\n  return new Matrix([1,0,0, 0,1,0, 0,0,1]);\n};\nMatrix.Rotation = function(angle, u) {\n  var sina = sin(angle), cosa = cos(angle), mcos = 1 - cosa;\n  return new Matrix([\n    cosa + pow(u.x, 2) * mcos, u.x * u.y * mcos - u.z * sina, u.x * u.z * mcos + u.y * sina,\n    u.y * u.x * mcos + u.z * sina, cosa + pow(u.y, 2) * mcos, u.y * u.z * mcos - u.x * sina,\n    u.z * u.x * mcos - u.y * sina, u.z * u.y * mcos + u.x * sina, cosa + pow(u.z, 2) * mcos\n  ]);\n}\nMproto.mul = function(m) {\n  var a = [], i, j, mmatrix = (m.xform ? 1 : 0);\n  for(i = 1; i <= 3; ++i)\n    for(j = 1; j <= 3; ++j) {\n      if(mmatrix)\n        a.push(this[i][1] * m[1][j] +\n          this[i][2] * m[2][j] +\n          this[i][3] * m[3][j]);\n      else\n        a.push(this[i][j] * m);\n    }\n  return new Matrix(a);\n};\nMproto.xform = function(p) {\n  var a = {}, x = p.x, y = p.y, z = p.z;\n  a.x = x * this[1][1] + y * this[2][1] + z * this[3][1];\n  a.y = x * this[1][2] + y * this[2][2] + z * this[3][2];\n  a.z = x * this[1][3] + y * this[2][3] + z * this[3][3];\n  return a;\n};\nfunction PointsOnSphere(n,xr,yr,zr) {\n  var i, y, r, phi, pts = [], inc = Math.PI * (3-sqrt(5)), off = 2/n;\n  for(i = 0; i < n; ++i) {\n    y = i * off - 1 + (off / 2);\n    r = sqrt(1 - y*y);\n    phi = i * inc;\n    pts.push([cos(phi) * r * xr, y * yr, sin(phi) * r * zr]);\n  }\n  return pts;\n}\nfunction Cylinder(n,o,xr,yr,zr) {\n  var phi, pts = [], inc = Math.PI * (3-sqrt(5)), off = 2/n, i, j, k, l;\n  for(i = 0; i < n; ++i) {\n    j = i * off - 1 + (off / 2);\n    phi = i * inc;\n    k = cos(phi);\n    l = sin(phi);\n    pts.push(o ? [j * xr, k * yr, l * zr] : [k * xr, j * yr, l * zr]);\n  }\n  return pts;\n}\nfunction Ring(o, n, xr, yr, zr, j) {\n  var phi, pts = [], inc = Math.PI * 2 / n, i, k, l;\n  for(i = 0; i < n; ++i) {\n    phi = i * inc;\n    k = cos(phi);\n    l = sin(phi);\n    pts.push(o ? [j * xr, k * yr, l * zr] : [k * xr, j * yr, l * zr]);\n  }\n  return pts;\n}\nfunction PointsOnCylinderV(n,xr,yr,zr) { return Cylinder(n, 0, xr, yr, zr) }\nfunction PointsOnCylinderH(n,xr,yr,zr) { return Cylinder(n, 1, xr, yr, zr) }\nfunction PointsOnRingV(n, xr, yr, zr, offset) {\n  offset = isNaN(offset) ? 0 : offset * 1;\n  return Ring(0, n, xr, yr, zr, offset);\n}\nfunction PointsOnRingH(n, xr, yr, zr, offset) {\n  offset = isNaN(offset) ? 0 : offset * 1;\n  return Ring(1, n, xr, yr, zr, offset);\n}\nfunction CentreImage(t) {\n  var i = new Image;\n  i.onload = function() {\n    var dx = i.width / 2, dy = i.height / 2;\n    t.centreFunc = function(c, w, h, cx, cy) {\n      c.setTransform(1, 0, 0, 1, 0, 0);\n      c.globalAlpha = 1;\n      c.drawImage(i, cx - dx, cy - dy);\n    };\n  };\n  i.src = t.centreImage;\n}\nfunction SetAlpha(c,a) {\n  var d = c, p1, p2, ae = (a*1).toPrecision(3) + ')';\n  if(c[0] === '#') {\n    if(!hexlookup3[c])\n      if(c.length === 4)\n        hexlookup3[c] = 'rgba(' + hexlookup1[c[1]] + hexlookup1[c[2]] + hexlookup1[c[3]];\n      else\n        hexlookup3[c] = 'rgba(' + hexlookup2[c.substr(1,2)] + hexlookup2[c.substr(3,2)] + hexlookup2[c.substr(5,2)];\n    d = hexlookup3[c] + ae;\n  } else if(c.substr(0,4) === 'rgb(' || c.substr(0,4) === 'hsl(') {\n    d = (c.replace('(','a(').replace(')', ',' + ae));\n  } else if(c.substr(0,5) === 'rgba(' || c.substr(0,5) === 'hsla(') {\n    p1 = c.lastIndexOf(',') + 1, p2 = c.indexOf(')');\n    a *= parseFloat(c.substring(p1,p2));\n    d = c.substr(0,p1) + a.toPrecision(3) + ')';\n  }\n  return d;\n}\nfunction NewCanvas(w,h) {\n  // if using excanvas, give up now\n  if(window.G_vmlCanvasManager)\n    return null;\n  var c = doc.createElement('canvas');\n  c.width = w;\n  c.height = h;\n  return c;\n}\n// I think all browsers pass this test now...\nfunction ShadowAlphaBroken() {\n  var cv = NewCanvas(3,3), c, i;\n  if(!cv)\n    return false;\n  c = cv.getContext('2d');\n  c.strokeStyle = '#000';\n  c.shadowColor = '#fff';\n  c.shadowBlur = 3;\n  c.globalAlpha = 0;\n  c.strokeRect(2,2,2,2);\n  c.globalAlpha = 1;\n  i = c.getImageData(2,2,1,1);\n  cv = null;\n  return (i.data[0] > 0);\n}\nfunction SetGradient(c, l, o, g) {\n  var gd = c.createLinearGradient(0, 0, l, 0), i;\n  for(i in g)\n    gd.addColorStop(1 - i, g[i]);\n  c.fillStyle = gd;\n  c.fillRect(0, o, l, 1);\n}\nfunction FindGradientColour(tc, p, r) {\n  var l = 1024, h = 1, gl = tc.weightGradient, cv, c, i, d;\n  if(tc.gCanvas) {\n    c = tc.gCanvas.getContext('2d');\n    h = tc.gCanvas.height;\n  } else {\n    if(IsObject(gl[0]))\n      h = gl.length;\n    else\n      gl = [gl];\n    tc.gCanvas = cv = NewCanvas(l, h);\n    if(!cv)\n      return null;\n    c = cv.getContext('2d');\n    for(i = 0; i < h; ++i)\n      SetGradient(c, l, i, gl[i]);\n  }\n  r = max(min(r || 0, h - 1), 0);\n  d = c.getImageData(~~((l - 1) * p), r, 1, 1).data;\n  return 'rgba(' + d[0] + ',' + d[1] + ',' + d[2] + ',' + (d[3]/255) + ')';\n}\nfunction TextSet(ctxt, font, colour, strings, padx, pady, shadowColour,\n  shadowBlur, shadowOffsets, maxWidth, widths, align) {\n  var xo = padx + (shadowBlur || 0) + \n    (shadowOffsets.length && shadowOffsets[0] < 0 ? abs(shadowOffsets[0]) : 0),\n    yo = pady + (shadowBlur || 0) + \n    (shadowOffsets.length && shadowOffsets[1] < 0 ? abs(shadowOffsets[1]) : 0), i, xc;\n  ctxt.font = font;\n  ctxt.textBaseline = 'top';\n  ctxt.fillStyle = colour;\n  shadowColour && (ctxt.shadowColor = shadowColour);\n  shadowBlur && (ctxt.shadowBlur = shadowBlur);\n  shadowOffsets.length && (ctxt.shadowOffsetX = shadowOffsets[0],\n    ctxt.shadowOffsetY = shadowOffsets[1]);\n  for(i = 0; i < strings.length; ++i) {\n    xc = 0;\n    if(widths) {\n      if('right' == align) {\n        xc = maxWidth - widths[i];\n      } else if('centre' == align) {\n        xc = (maxWidth - widths[i]) / 2;\n      }\n    }\n    ctxt.fillText(strings[i], xo + xc, yo);\n    yo += parseInt(font);\n  }\n}\nfunction RRect(c, x, y, w, h, r, s) {\n  if(r) {\n    c.beginPath();\n    c.moveTo(x, y + h - r);\n    c.arcTo(x, y, x + r, y, r);\n    c.arcTo(x + w, y, x + w, y + r, r);\n    c.arcTo(x + w, y + h, x + w - r, y + h, r);\n    c.arcTo(x, y + h, x, y + h - r, r);\n    c.closePath();\n    c[s ? 'stroke' : 'fill']();\n  } else {\n    c[s ? 'strokeRect' : 'fillRect'](x, y, w, h);\n  }\n}\nfunction TextCanvas(strings, font, w, h, maxWidth, stringWidths, align, valign,\n  scale) {\n  this.strings = strings;\n  this.font = font;\n  this.width = w;\n  this.height = h;\n  this.maxWidth = maxWidth;\n  this.stringWidths = stringWidths;\n  this.align = align;\n  this.valign = valign;\n  this.scale = scale;\n}\nTCVproto = TextCanvas.prototype;\nTCVproto.SetImage = function(image, w, h, position, padding, align, valign,\n  scale) {\n  this.image = image;\n  this.iwidth = w * this.scale;\n  this.iheight = h * this.scale;\n  this.ipos = position;\n  this.ipad = padding * this.scale;\n  this.iscale = scale;\n  this.ialign = align;\n  this.ivalign = valign;\n};\nTCVproto.Align = function(size, space, a) {\n  var pos = 0;\n  if(a == 'right' || a == 'bottom')\n    pos = space - size;\n  else if(a != 'left' && a != 'top')\n    pos = (space - size) / 2;\n  return pos;\n};\nTCVproto.Create = function(colour, bgColour, bgOutline, bgOutlineThickness,\n  shadowColour, shadowBlur, shadowOffsets, padding, radius) {\n  var cv, cw, ch, c, x1, x2, y1, y2, offx, offy, ix, iy, iw, ih,\n    sox = abs(shadowOffsets[0]), soy = abs(shadowOffsets[1]), shadowcv, shadowc;\n  padding = max(padding, sox + shadowBlur, soy + shadowBlur);\n  x1 = 2 * (padding + bgOutlineThickness);\n  y1 = 2 * (padding + bgOutlineThickness);\n  cw = this.width + x1;\n  ch = this.height + y1;\n  offx = offy = padding + bgOutlineThickness;\n\n  if(this.image) {\n    ix = iy = padding + bgOutlineThickness;\n    iw = this.iwidth;\n    ih = this.iheight;\n    if(this.ipos == 'top' || this.ipos == 'bottom') {\n      if(iw < this.width)\n        ix += this.Align(iw, this.width, this.ialign);\n      else\n        offx += this.Align(this.width, iw, this.align);\n      if(this.ipos == 'top')\n        offy += ih + this.ipad;\n      else\n        iy += this.height + this.ipad;\n      cw = max(cw, iw + x1);\n      ch += ih + this.ipad;\n    } else {\n      if(ih < this.height)\n        iy += this.Align(ih, this.height, this.ivalign);\n      else\n        offy += this.Align(this.height, ih, this.valign);\n      if(this.ipos == 'right')\n        ix += this.width + this.ipad;\n      else\n        offx += iw + this.ipad;\n      cw += iw + this.ipad;\n      ch = max(ch, ih + y1);\n    }\n  }\n\n  cv = NewCanvas(cw, ch);\n  if(!cv)\n    return null;\n  x1 = y1 = bgOutlineThickness / 2;\n  x2 = cw - bgOutlineThickness;\n  y2 = ch - bgOutlineThickness;\n  c = cv.getContext('2d');\n  if(bgColour) {\n    c.fillStyle = bgColour;\n    RRect(c, x1, y1, x2, y2, radius);\n  }\n  if(bgOutlineThickness) {\n    c.strokeStyle = bgOutline;\n    c.lineWidth = bgOutlineThickness;\n    RRect(c, x1, y1, x2, y2, radius, true);\n  }\n  if(shadowBlur || sox || soy) {\n    // use a transparent canvas to draw on\n    shadowcv = NewCanvas(cw, ch);\n    if(shadowcv) {\n      shadowc = c;\n      c = shadowcv.getContext('2d');\n    }\n  }\n\n  // don't use TextSet shadow support because it adds space for shadow\n  TextSet(c, this.font, colour, this.strings, offx, offy, 0, 0, [],\n    this.maxWidth, this.stringWidths, this.align);\n      \n  if(this.image)\n    c.drawImage(this.image, ix, iy, iw, ih);\n\n  if(shadowc) {\n    // draw the text and image with the added shadow\n    c = shadowc;\n    shadowColour && (c.shadowColor = shadowColour);\n    shadowBlur && (c.shadowBlur = shadowBlur);\n    c.shadowOffsetX = shadowOffsets[0];\n    c.shadowOffsetY = shadowOffsets[1];\n    c.drawImage(shadowcv, 0, 0);\n  }\n  return cv;\n};\nfunction ExpandImage(i, w, h) {\n  var cv = NewCanvas(w, h), c;\n  if(!cv)\n    return null;\n  c = cv.getContext('2d');\n  c.drawImage(i, (w - i.width) / 2, (h - i.height) / 2);\n  return cv;\n}\nfunction ScaleImage(i, w, h) {\n  var cv = NewCanvas(w, h), c;\n  if(!cv)\n    return null;\n  c = cv.getContext('2d');\n  c.drawImage(i, 0, 0, w, h);\n  return cv;\n}\nfunction AddBackgroundToImage(i, w, h, scale, colour, othickness, ocolour,\n  padding, radius, ofill) {\n  var cw = w + ((2 * padding) + othickness) * scale,\n    ch = h + ((2 * padding) + othickness) * scale,\n    cv = NewCanvas(cw, ch), c, x1, y1, x2, y2, ocanvas, cc;\n  if(!cv)\n    return null;\n  othickness *= scale;\n  radius *= scale;\n  x1 = y1 = othickness / 2;\n  x2 = cw - othickness;\n  y2 = ch - othickness;\n  padding = (padding * scale) + x1; // add space for outline\n  c = cv.getContext('2d');\n  if(colour) {\n    c.fillStyle = colour;\n    RRect(c, x1, y1, x2, y2, radius);\n  }\n  if(othickness) {\n    c.strokeStyle = ocolour;\n    c.lineWidth = othickness;\n    RRect(c, x1, y1, x2, y2, radius, true);\n  }\n  \n  if(ofill) {\n    // use compositing to colour in the image and border\n    ocanvas = NewCanvas(cw, ch);\n    cc = ocanvas.getContext('2d');\n    cc.drawImage(i, padding, padding, w, h);\n    cc.globalCompositeOperation = 'source-in';\n    cc.fillStyle = ocolour;\n    cc.fillRect(0, 0, cw, ch);\n    cc.globalCompositeOperation = 'destination-over';\n    cc.drawImage(cv, 0, 0);\n    cc.globalCompositeOperation = 'source-over';\n    c.drawImage(ocanvas, 0, 0);\n  } else {\n    c.drawImage(i, padding, padding, i.width, i.height);\n  }\n  return {image: cv, width: cw / scale, height: ch / scale};\n}\n/**\n * Creates a new canvas containing the image and its shadow\n * Returns an object containing the image and its dimensions at z=0\n */\nfunction AddShadowToImage(i, w, h, scale, sc, sb, so) {\n  var sw = abs(so[0]), sh = abs(so[1]), \n    cw = w + (sw > sb ? sw + sb : sb * 2) * scale,\n    ch = h + (sh > sb ? sh + sb : sb * 2) * scale,\n    xo = scale * ((sb || 0) + (so[0] < 0 ? sw : 0)),\n    yo = scale * ((sb || 0) + (so[1] < 0 ? sh : 0)), cv, c;\n  cv = NewCanvas(cw, ch);\n  if(!cv)\n    return null;\n  c = cv.getContext('2d');\n  sc && (c.shadowColor = sc);\n  sb && (c.shadowBlur = sb * scale);\n  so && (c.shadowOffsetX = so[0] * scale, c.shadowOffsetY = so[1] * scale);\n  c.drawImage(i, xo, yo, w, h);\n  return {image: cv, width: cw / scale, height: ch / scale};\n}\nfunction FindTextBoundingBox(s,f,ht) {\n  var w = parseInt(s.toString().length * ht), h = parseInt(ht * 2 * s.length),\n    cv = NewCanvas(w,h), c, idata, w1, h1, x, y, i, ex;\n  if(!cv)\n    return null;\n  c = cv.getContext('2d');\n  c.fillStyle = '#000';\n  c.fillRect(0,0,w,h);\n  TextSet(c,ht + 'px ' + f,'#fff',s,0,0,0,0,[],'centre')\n\n  idata = c.getImageData(0,0,w,h);\n  w1 = idata.width; h1 = idata.height;\n  ex = {\n    min: { x: w1, y: h1 },\n    max: { x: -1, y: -1 }\n  };\n  for(y = 0; y < h1; ++y) {\n    for(x = 0; x < w1; ++x) {\n      i = (y * w1 + x) * 4;\n      if(idata.data[i+1] > 0) {\n        if(x < ex.min.x) ex.min.x = x;\n        if(x > ex.max.x) ex.max.x = x;\n        if(y < ex.min.y) ex.min.y = y;\n        if(y > ex.max.y) ex.max.y = y;\n      }\n    }\n  }\n  // device pixels might not be css pixels\n  if(w1 != w) {\n    ex.min.x *= (w / w1);\n    ex.max.x *= (w / w1);\n  }\n  if(h1 != h) {\n    ex.min.y *= (w / h1);\n    ex.max.y *= (w / h1);\n  }\n\n  cv = null;\n  return ex;\n}\nfunction FixFont(f) {\n  return \"'\" + f.replace(/(\\'|\\\")/g,'').replace(/\\s*,\\s*/g, \"', '\") + \"'\";\n}\nfunction AddHandler(h,f,e) {\n  e = e || doc;\n  if(e.addEventListener)\n    e.addEventListener(h,f,false);\n  else\n    e.attachEvent('on' + h, f);\n}\nfunction RemoveHandler(h,f,e) {\n  e = e || doc;\n  if(e.removeEventListener)\n    e.removeEventListener(h, f);\n  else\n    e.detachEvent('on' + h, f);\n}\nfunction AddImage(i, o, t, tc) {\n  var s = tc.imageScale, mscale, ic, bc, oc, iw, ih;\n  // image not loaded, wait for image onload\n  if(!o.complete)\n    return AddHandler('load',function() { AddImage(i,o,t,tc); }, o);\n  if(!i.complete)\n    return AddHandler('load',function() { AddImage(i,o,t,tc); }, i);\n\n  // Yes, this does look like nonsense, but it makes sure that both the\n  // width and height are actually set and not just calculated. This is\n  // required to keep proportional sizes when the images are hidden, so\n  // the images can be used again for another cloud.\n  o.width = o.width;\n  o.height = o.height;\n\n  if(s) {\n    i.width = o.width * s;\n    i.height = o.height * s;\n  }\n  // the standard width of the image, with imageScale applied\n  t.iw = i.width;\n  t.ih = i.height;\n  if(tc.txtOpt) {\n    ic = i;\n    mscale = tc.zoomMax * tc.txtScale;\n    iw = t.iw * mscale;\n    ih = t.ih * mscale;\n    if(iw < o.naturalWidth || ih < o.naturalHeight) {\n      ic = ScaleImage(i, iw, ih);\n      if(ic)\n        t.fimage = ic;\n    } else {\n      iw = t.iw;\n      ih = t.ih;\n      mscale = 1;\n    }\n    if(!t.HasText()) {\n      if(tc.shadow) {\n        ic = AddShadowToImage(t.image, iw, ih, mscale, tc.shadow, tc.shadowBlur,\n          tc.shadowOffset);\n        if(ic) {\n          t.fimage = ic.image;\n          t.w = ic.width;\n          t.h = ic.height;\n        }\n      }\n      if(tc.bgColour || tc.bgOutlineThickness) {\n        bc = tc.bgColour == 'tag' ? GetProperty(t.a, 'background-color') :\n          tc.bgColour;\n        oc = tc.bgOutline == 'tag' ? GetProperty(t.a, 'color') : \n          (tc.bgOutline || tc.textColour);\n        iw = t.fimage.width;\n        ih = t.fimage.height;\n        if(tc.outlineMethod == 'colour') {\n          // create the outline version first, using the current image state\n          ic = AddBackgroundToImage(t.fimage, iw, ih, mscale, bc,\n            tc.bgOutlineThickness, tc.outlineColour, tc.padding, tc.bgRadius, 1);\n          if(ic)\n            t.oimage = ic.image;\n        }\n        ic = AddBackgroundToImage(t.fimage, iw, ih, mscale, bc, \n          tc.bgOutlineThickness, oc, tc.padding, tc.bgRadius);\n        if(ic) {\n          t.fimage = ic.image;\n          t.w = ic.width;\n          t.h = ic.height;\n        }\n      }\n      if(tc.outlineMethod == 'size') {\n        if(tc.outlineIncrease > 0) {\n          t.iw += 2 * tc.outlineIncrease;\n          t.ih += 2 * tc.outlineIncrease;\n          iw = mscale * t.iw;\n          ih = mscale * t.ih;\n          ic = ScaleImage(t.fimage, iw, ih);\n          t.oimage = ic;\n          t.fimage = ExpandImage(t.fimage, t.oimage.width, t.oimage.height);\n        } else {\n          iw = mscale * (t.iw + (2 * tc.outlineIncrease));\n          ih = mscale * (t.ih + (2 * tc.outlineIncrease));\n          ic = ScaleImage(t.fimage, iw, ih);\n          t.oimage = ExpandImage(ic, t.fimage.width, t.fimage.height);\n        }\n      }\n    }\n  }\n  t.Init();\n}\nfunction GetProperty(e,p) {\n  var dv = doc.defaultView, pc = p.replace(/\\-([a-z])/g,function(a){return a.charAt(1).toUpperCase()});\n  return (dv && dv.getComputedStyle && dv.getComputedStyle(e,null).getPropertyValue(p)) ||\n    (e.currentStyle && e.currentStyle[pc]);\n}\nfunction FindWeight(a, wFrom, tHeight) {\n  var w = 1, p;\n  if(wFrom) {\n    w = 1 * (a.getAttribute(wFrom) || tHeight);\n  } else if(p = GetProperty(a,'font-size')) {\n    w = (p.indexOf('px') > -1 && p.replace('px','') * 1) ||\n      (p.indexOf('pt') > -1 && p.replace('pt','') * 1.25) ||\n      p * 3.3;\n  }\n  return w;\n}\nfunction EventToCanvasId(e) {\n  return e.target && Defined(e.target.id) ? e.target.id :\n    e.srcElement.parentNode.id;\n}\nfunction EventXY(e, c) {\n  var xy, p, xmul = parseInt(GetProperty(c, 'width')) / c.width,\n    ymul = parseInt(GetProperty(c, 'height')) / c.height;\n  if(Defined(e.offsetX)) {\n    xy = {x: e.offsetX, y: e.offsetY};\n  } else {\n    p = AbsPos(c.id);\n    if(Defined(e.changedTouches))\n      e = e.changedTouches[0];\n    if(e.pageX)\n      xy = {x: e.pageX - p.x, y: e.pageY - p.y};\n  }\n  if(xy && xmul && ymul) {\n    xy.x /= xmul;\n    xy.y /= ymul;\n  }\n  return xy;\n}\nfunction MouseOut(e) {\n  var cv = e.target || e.fromElement.parentNode, tc = TagCanvas.tc[cv.id];\n  if(tc) {\n   tc.mx = tc.my = -1;\n   tc.UnFreeze();\n   tc.EndDrag();\n  }\n}\nfunction MouseMove(e) {\n  return;\n  var i, t = TagCanvas, tc, p, tg = EventToCanvasId(e);\n  for(i in t.tc) {\n    tc = t.tc[i];\n    if(tc.tttimer) {\n      clearTimeout(tc.tttimer);\n      tc.tttimer = null;\n    }\n  }\n  if(tg && t.tc[tg]) {\n    tc = t.tc[tg];\n    if(p = EventXY(e, tc.canvas)) {\n      tc.mx = p.x;\n      tc.my = p.y;\n      tc.Drag(e, p);\n    }\n    tc.drawn = 0;\n  }\n}\nfunction MouseDown(e) {\n  var t = TagCanvas, cb = doc.addEventListener ? 0 : 1,\n    tg = EventToCanvasId(e);\n  if(tg && e.button == cb && t.tc[tg]) {\n    t.tc[tg].BeginDrag(e);\n  }\n}\nfunction MouseUp(e) {\n  var t = TagCanvas, cb = doc.addEventListener ? 0 : 1,\n    tg = EventToCanvasId(e), tc;\n  if(tg && e.button == cb && t.tc[tg]) {\n    tc = t.tc[tg];\n    MouseMove(e);\n    if(!tc.EndDrag() && !tc.touchState)\n      tc.Clicked(e);\n  }\n}\nfunction TouchDown(e) {\n  var tg = EventToCanvasId(e), tc = (tg && TagCanvas.tc[tg]), p;\n  if(tc && e.changedTouches) {\n    if(e.touches.length == 1 && tc.touchState == 0) {\n      tc.touchState = 1;\n      tc.BeginDrag(e);\n      if(p = EventXY(e, tc.canvas)) {\n        tc.mx = p.x;\n        tc.my = p.y;\n        tc.drawn = 0;\n      }\n    } else if(e.targetTouches.length == 2 && tc.pinchZoom) {\n      tc.touchState = 3;\n      tc.EndDrag();\n      tc.BeginPinch(e);\n    } else {\n      tc.EndDrag();\n      tc.EndPinch();\n      tc.touchState = 0;\n    }\n  }\n}\nfunction TouchUp(e) {\n  var tg = EventToCanvasId(e), tc = (tg && TagCanvas.tc[tg]);\n  if(tc && e.changedTouches) {\n    switch(tc.touchState) {\n    case 1:\n      tc.Draw();\n      tc.Clicked();\n      break;\n    case 2:\n      tc.EndDrag();\n      break;\n    case 3:\n      tc.EndPinch();\n    }\n    tc.touchState = 0;\n  }\n}\nfunction TouchMove(e) {\n  var i, t = TagCanvas, tc, p, tg = EventToCanvasId(e);\n  for(i in t.tc) {\n    tc = t.tc[i];\n    if(tc.tttimer) {\n      clearTimeout(tc.tttimer);\n      tc.tttimer = null;\n    }\n  }\n  tc = (tg && t.tc[tg]);\n  if(tc && e.changedTouches && tc.touchState) {\n    switch(tc.touchState) {\n    case 1:\n    case 2:\n      if(p = EventXY(e, tc.canvas)) {\n        tc.mx = p.x;\n        tc.my = p.y;\n        if(tc.Drag(e, p))\n          tc.touchState = 2;\n      }\n      break;\n    case 3:\n      tc.Pinch(e);\n    }\n    tc.drawn = 0;\n  }\n}\nfunction MouseWheel(e) {\n  var t = TagCanvas, tg = EventToCanvasId(e);\n  if(tg && t.tc[tg]) {\n    e.cancelBubble = true;\n    e.returnValue = false;\n    e.preventDefault && e.preventDefault();\n    t.tc[tg].Wheel((e.wheelDelta || e.detail) > 0);\n  }\n}\nfunction DrawCanvas() {\n  DrawCanvasRAF(TimeNow());\n}\nfunction DrawCanvasRAF(t) {\n  var tc = TagCanvas.tc, i;\n  TagCanvas.NextFrame(TagCanvas.interval);\n  t = t || TimeNow();\n  for(i in tc)\n    tc[i].Draw(t);\n}\nfunction AbsPos(id) {\n  var e = doc.getElementById(id), r = e.getBoundingClientRect(),\n    dd = doc.documentElement, b = doc.body, w = window,\n    xs = w.pageXOffset || dd.scrollLeft,\n    ys = w.pageYOffset || dd.scrollTop,\n    xo = dd.clientLeft || b.clientLeft,\n    yo = dd.clientTop || b.clientTop;\n  return { x: r.left + xs - xo, y: r.top + ys - yo };\n}\nfunction Project(tc,p1,sx,sy) {\n  var m = tc.radius * tc.z1 / (tc.z1 + tc.z2 + p1.z);\n  return {\n    x: p1.x * m * sx,\n    y: p1.y * m * sy,\n    z: p1.z,\n    w: (tc.z1 - p1.z) / tc.z2\n  };\n}\n/**\n * @constructor\n * for recursively splitting tag contents on <br> tags\n */\nfunction TextSplitter(e) {\n  this.e = e;\n  this.br = 0;\n  this.line = [];\n  this.text = [];\n  this.original = e.innerText || e.textContent;\n}\nTSproto = TextSplitter.prototype;\nTSproto.Empty = function() {\n  for(var i = 0; i < this.text.length; ++i)\n    if(this.text[i].length)\n      return false;\n  return true;\n};\nTSproto.Lines = function(e) {\n  var r = e ? 1 : 0, cn, cl, i;\n  e = e || this.e;\n  cn = e.childNodes;\n  cl = cn.length;\n\n  for(i = 0; i < cl; ++i) {\n    if(cn[i].nodeName == 'BR') {\n      this.text.push(this.line.join(' '));\n      this.br = 1;\n    } else if(cn[i].nodeType == 3) {\n      if(this.br) {\n        this.line = [cn[i].nodeValue];\n        this.br = 0;\n      } else {\n        this.line.push(cn[i].nodeValue);\n      }\n    } else {\n      this.Lines(cn[i]);\n    }\n  }\n  r || this.br || this.text.push(this.line.join(' '));\n  return this.text;\n};\nTSproto.SplitWidth = function(w, c, f, h) {\n  var i, j, words, text = [];\n  c.font = h + 'px ' + f;\n  for(i = 0; i < this.text.length; ++i) {\n    words = this.text[i].split(/\\s+/);\n    this.line = [words[0]];\n    for(j = 1; j < words.length; ++j) {\n      if(c.measureText(this.line.join(' ') + ' ' + words[j]).width > w) {\n        text.push(this.line.join(' '));\n        this.line = [words[j]];\n      } else {\n        this.line.push(words[j]);\n      }\n    }\n    text.push(this.line.join(' '));\n  }\n  return this.text = text;\n};\n/**\n * @constructor\n */\nfunction Outline(tc,t) {\n  this.ts = TimeNow();\n  this.tc = tc;\n  this.tag = t;\n  this.x = this.y = this.w = this.h = this.sc = 1;\n  this.z = 0;\n  this.Draw = tc.pulsateTo < 1 && tc.outlineMethod != 'colour' ? \n    this.DrawPulsate : this.DrawSimple;\n  this.radius = tc.outlineRadius | 0;\n  this.SetMethod(tc.outlineMethod);\n}\nOproto = Outline.prototype;\nOproto.SetMethod = function(om) {\n  var methods = {\n    block: ['PreDraw','DrawBlock'],\n    colour: ['PreDraw','DrawColour'],\n    outline: ['PostDraw','DrawOutline'],\n    classic: ['LastDraw','DrawOutline'],\n    size: ['PreDraw','DrawColour'],\n    none: ['LastDraw']\n  }, funcs = methods[om] || methods.outline;\n  if(om == 'none') {\n    this.Draw = function() { return 1; }\n  } else {\n    this.drawFunc = this[funcs[1]];\n  }\n  this[funcs[0]] = this.Draw;\n};\nOproto.Update = function(x,y,w,h,sc,z,xo,yo) {\n  var o = this.tc.outlineOffset, o2 = 2 * o;\n  this.x = sc * x + xo - o;\n  this.y = sc * y + yo - o;\n  this.w = sc * w + o2;\n  this.h = sc * h + o2;\n  this.sc = sc; // used to determine frontmost\n  this.z = z;\n};\nOproto.DrawOutline = function(c,x,y,w,h,colour) {\n  c.strokeStyle = colour;\n  RRect(c, x, y, w, h, this.radius, true);\n};\nOproto.DrawColour = function(c,x,y,w,h,colour,tag,x1,y1) {\n  if(tag.oimage) {\n    tag.alpha = 1;\n    tag.Draw(c, x1, y1, tag.oimage);\n    return 1;\n  }\n  return this[tag.image ? 'DrawColourImage' : 'DrawColourText'](c,x,y,w,h,colour,tag,x1,y1);\n};\nOproto.DrawColourText = function(c,x,y,w,h,colour,tag,x1,y1) {\n  var normal = tag.colour;\n  tag.colour = colour;\n  tag.alpha = 1;\n  tag.Draw(c,x1,y1);\n  tag.colour = normal;\n  return 1;\n};\nOproto.DrawColourImage = function(c,x,y,w,h,colour,tag,x1,y1) {\n  var ccanvas = c.canvas, fx = ~~max(x,0), fy = ~~max(y,0), \n    fw = min(ccanvas.width - fx, w) + .5|0, fh = min(ccanvas.height - fy,h) + .5|0, cc;\n  if(ocanvas)\n    ocanvas.width = fw, ocanvas.height = fh;\n  else\n    ocanvas = NewCanvas(fw, fh);\n  if(!ocanvas)\n    return this.SetMethod('outline'); // if using IE and images, give up!\n  cc = ocanvas.getContext('2d');\n\n  cc.drawImage(ccanvas,fx,fy,fw,fh,0,0,fw,fh);\n  c.clearRect(fx,fy,fw,fh);\n  tag.alpha = 1;\n  tag.Draw(c,x1,y1);\n  c.setTransform(1,0,0,1,0,0);\n  c.save();\n  c.beginPath();\n  c.rect(fx,fy,fw,fh);\n  c.clip();\n  c.globalCompositeOperation = 'source-in';\n  c.fillStyle = colour;\n  c.fillRect(fx,fy,fw,fh);\n  c.restore();\n  c.globalCompositeOperation = 'destination-over';\n  c.drawImage(ocanvas,0,0,fw,fh,fx,fy,fw,fh);\n  c.globalCompositeOperation = 'source-over';\n  return 1;\n};\nOproto.DrawBlock = function(c,x,y,w,h,colour) {\n  c.fillStyle = colour;\n  RRect(c, x, y, w, h, this.radius);\n};\nOproto.DrawSimple = function(c, tag, x1, y1) {\n  var t = this.tc;\n  c.setTransform(1,0,0,1,0,0);\n  c.strokeStyle = t.outlineColour;\n  c.lineWidth = t.outlineThickness;\n  c.shadowBlur = c.shadowOffsetX = c.shadowOffsetY = 0;\n  c.globalAlpha = 1;\n  return this.drawFunc(c,this.x,this.y,this.w,this.h,t.outlineColour,tag,x1,y1);\n};\nOproto.DrawPulsate = function(c, tag, x1, y1) {\n  var diff = TimeNow() - this.ts, t = this.tc;\n  c.setTransform(1,0,0,1,0,0);\n  c.strokeStyle = t.outlineColour;\n  c.lineWidth = t.outlineThickness;\n  c.shadowBlur = c.shadowOffsetX = c.shadowOffsetY = 0;\n  c.globalAlpha = t.pulsateTo + ((1 - t.pulsateTo) * \n    (0.5 + (cos(2 * Math.PI * diff / (1000 * t.pulsateTime)) / 2)));\n  return this.drawFunc(c,this.x,this.y,this.w,this.h,t.outlineColour,tag,x1,y1);\n};\nOproto.Active = function(c,x,y) {\n  return (x >= this.x && y >= this.y &&\n    x <= this.x + this.w && y <= this.y + this.h);\n};\nOproto.PreDraw = Oproto.PostDraw = Oproto.LastDraw = Nop;\n/**\n * @constructor\n */\nfunction Tag(tc, text, a, v, w, h, col, bcol, bradius, boutline, bothickness,\n  font, padding, original) {\n  this.tc = tc;\n  this.image = null;\n  this.text = text;\n  this.text_original = original;\n  this.line_widths = [];\n  this.title = a.title || null;\n  this.a = a;\n  this.position = new Vector(v[0], v[1], v[2]);\n  this.x = this.y = this.z = 0;\n  this.w = w;\n  this.h = h;\n  this.colour = col || tc.textColour;\n  this.bgColour = bcol || tc.bgColour;\n  this.bgRadius = bradius | 0;\n  this.bgOutline = boutline || this.colour;\n  this.bgOutlineThickness = bothickness | 0;\n  this.textFont = font || tc.textFont;\n  this.padding = padding | 0;\n  this.sc = this.alpha = 1;\n  this.weighted = !tc.weight;\n}\nTproto = Tag.prototype;\nTproto.Init = function(e) {\n  var tc = this.tc;\n  this.outline = new Outline(tc,this);\n  this.textHeight = tc.textHeight;\n  if(this.HasText()) {\n    this.Measure(tc.ctxt,tc);\n  } else {\n    this.w = this.iw;\n    this.h = this.ih;\n  }\n\n  this.SetShadowColour = tc.shadowAlpha ? this.SetShadowColourAlpha : this.SetShadowColourFixed;\n  this.SetDraw(tc);\n};\nTproto.Draw = Nop;\nTproto.HasText = function() {\n  return this.text && this.text[0].length > 0;\n};\nTproto.EqualTo = function(e) {\n  var i = e.getElementsByTagName('img');\n  if(this.a.href != e.href)\n    return 0;\n  if(i.length)\n    return this.image.src == i[0].src;\n  return (e.innerText || e.textContent) == this.text_original;\n};\nTproto.SetImage = function(i) {\n  this.image = this.fimage = i;\n};\nTproto.SetDraw = function(t) {\n  this.Draw = this.fimage ? (t.ie > 7 ? this.DrawImageIE : this.DrawImage) : this.DrawText;\n  t.noSelect && (this.CheckActive = Nop);\n};\nTproto.MeasureText = function(c) {\n  var i, l = this.text.length, w = 0, wl;\n  for(i = 0; i < l; ++i) {\n    this.line_widths[i] = wl = c.measureText(this.text[i]).width;\n    w = max(w, wl);\n  }\n  return w;\n};\nTproto.Measure = function(c,t) {\n  var extents = FindTextBoundingBox(this.text, this.textFont, this.textHeight),\n    s, th, f, soff, cw, twidth, theight, img, tcv;\n  // add the gap at the top to the height to make equal gap at bottom\n  theight = extents ? extents.max.y + extents.min.y : this.textHeight;\n  c.font = this.font = this.textHeight + 'px ' + this.textFont;\n  twidth = this.MeasureText(c);\n  if(t.txtOpt) {\n    s = t.txtScale;\n    th = s * this.textHeight;\n    f = th + 'px ' + this.textFont;\n    soff = [s * t.shadowOffset[0], s * t.shadowOffset[1]];\n    c.font = f;\n    cw = this.MeasureText(c);\n    tcv = new TextCanvas(this.text, f, cw + s, (s * theight) + s, cw,\n      this.line_widths, t.textAlign, t.textVAlign, s);\n\n    if(this.image)\n      tcv.SetImage(this.image, this.iw, this.ih, t.imagePosition, t.imagePadding,\n        t.imageAlign, t.imageVAlign, t.imageScale);\n\n    img = tcv.Create(this.colour, this.bgColour, this.bgOutline,\n      s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff,\n      s * this.padding, s * this.bgRadius);\n\n    // add outline image using highlight colour\n    if(t.outlineMethod == 'colour') {\n      this.oimage = tcv.Create(t.outlineColour, this.bgColour, t.outlineColour,\n        s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff,\n        s * this.padding, s * this.bgRadius);\n\n    } else if(t.outlineMethod == 'size') {\n      extents = FindTextBoundingBox(this.text, this.textFont,\n        this.textHeight + t.outlineIncrease);\n      th = extents.max.y + extents.min.y;\n      f = (s * (this.textHeight + t.outlineIncrease)) + 'px ' + this.textFont;\n      c.font = f;\n      cw = this.MeasureText(c);\n\n      tcv = new TextCanvas(this.text, f, cw + s, (s * th) + s, cw,\n        this.line_widths, t.textAlign, t.textVAlign, s);\n      if(this.image)\n        tcv.SetImage(this.image, this.iw + t.outlineIncrease,\n          this.ih + t.outlineIncrease, t.imagePosition, t.imagePadding,\n          t.imageAlign, t.imageVAlign, t.imageScale);\n          \n      this.oimage = tcv.Create(this.colour, this.bgColour, this.bgOutline,\n        s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff,\n        s * this.padding, s * this.bgRadius);\n\n      if(t.outlineIncrease > 0)\n        img = ExpandImage(img, this.oimage.width, this.oimage.height);\n      else\n        this.oimage = ExpandImage(this.oimage, img.width, img.height);\n    }\n    if(img) {\n      this.fimage = img;\n      twidth = this.fimage.width / s;\n      theight = this.fimage.height / s;\n    }\n    this.SetDraw(t);\n    t.txtOpt = !!this.fimage;\n  }\n  this.h = theight;\n  this.w = twidth;\n};\nTproto.SetFont = function(f, c, bc, boc) {\n  this.textFont = f;\n  this.colour = c;\n  this.bgColour = bc;\n  this.bgOutline = boc;\n  this.Measure(this.tc.ctxt, this.tc);\n};\nTproto.SetWeight = function(w) {\n  var tc = this.tc, modes = tc.weightMode.split(/[, ]/), m, s, wl = w.length;\n  if(!this.HasText())\n    return;\n  this.weighted = true;\n  for(s = 0; s < wl; ++s) {\n    m = modes[s] || 'size';\n    if('both' == m) {\n      this.Weight(w[s], tc.ctxt, tc, 'size', tc.min_weight[s], \n        tc.max_weight[s], s);\n      this.Weight(w[s], tc.ctxt, tc, 'colour', tc.min_weight[s],\n        tc.max_weight[s], s);\n    } else {\n      this.Weight(w[s], tc.ctxt, tc, m, tc.min_weight[s], tc.max_weight[s], s);\n    }\n  }\n  this.Measure(tc.ctxt, tc);\n};\nTproto.Weight = function(w, c, t, m, wmin, wmax, wnum) {\n  w = isNaN(w) ? 1 : w;\n  var nweight = (w - wmin) / (wmax - wmin);\n  if('colour' == m)\n    this.colour = FindGradientColour(t, nweight, wnum);\n  else if('bgcolour' == m)\n    this.bgColour = FindGradientColour(t, nweight, wnum);\n  else if('bgoutline' == m)\n    this.bgOutline = FindGradientColour(t, nweight, wnum);\n  else if('size' == m) {\n    if(t.weightSizeMin > 0 && t.weightSizeMax > t.weightSizeMin) {\n      this.textHeight = t.weightSize * \n        (t.weightSizeMin + (t.weightSizeMax - t.weightSizeMin) * nweight);\n    } else {\n      // min textHeight of 1\n      this.textHeight = max(1, w * t.weightSize);\n    }\n  }\n};\nTproto.SetShadowColourFixed = function(c,s,a) {\n  c.shadowColor = s;\n};\nTproto.SetShadowColourAlpha = function(c,s,a) {\n  c.shadowColor = SetAlpha(s, a);\n};\nTproto.DrawText = function(c,xoff,yoff) {\n  var t = this.tc, x = this.x, y = this.y, s = this.sc, i, xl;\n  c.globalAlpha = this.alpha;\n  c.fillStyle = this.colour;\n  t.shadow && this.SetShadowColour(c,t.shadow,this.alpha);\n  c.font = this.font;\n  x += xoff / s;\n  y += (yoff / s) - (this.h / 2);\n  for(i = 0; i < this.text.length; ++i) {\n    xl = x;\n    if('right' == t.textAlign) {\n      xl += this.w / 2 - this.line_widths[i];\n    } else if('centre' == t.textAlign) {\n      xl -= this.line_widths[i] / 2;\n    } else {\n      xl -= this.w / 2;\n    }\n    c.setTransform(s, 0, 0, s, s * xl, s * y);\n    c.fillText(this.text[i], 0, 0);\n    y += this.textHeight;\n  }\n};\nTproto.DrawImage = function(c,xoff,yoff,im) {\n  var x = this.x, y = this.y, s = this.sc,\n    i = im || this.fimage, w = this.w, h = this.h, a = this.alpha,\n    shadow = this.shadow;\n  c.globalAlpha = a;\n  shadow && this.SetShadowColour(c,shadow,a);\n  x += (xoff / s) - (w / 2);\n  y += (yoff / s) - (h / 2);\n  c.setTransform(s, 0, 0, s, s * x, s * y);\n  c.drawImage(i, 0, 0, w, h);\n};\nTproto.DrawImageIE = function(c,xoff,yoff) {\n  var i = this.fimage, s = this.sc,\n    w = i.width = this.w*s, h = i.height = this.h * s,\n    x = (this.x*s) + xoff - (w/2), y = (this.y*s) + yoff - (h/2);\n  c.setTransform(1,0,0,1,0,0);\n  c.globalAlpha = this.alpha;\n  c.drawImage(i, x, y);\n};\nTproto.Calc = function(m,a) {\n  var pp, t = this.tc, mnb = t.minBrightness,\n    mxb = t.maxBrightness, r = t.max_radius;\n  pp = m.xform(this.position);\n  this.xformed = pp;\n  pp = Project(t, pp, t.stretchX, t.stretchY);\n  this.x = pp.x;\n  this.y = pp.y;\n  this.z = pp.z;\n  this.sc = pp.w;\n  this.alpha = a * Clamp(mnb + (mxb - mnb) * (r - this.z) / (2 * r), 0, 1);\n};\nTproto.UpdateActive = function(c, xoff, yoff) {\n  var o = this.outline, w = this.w, h = this.h,\n    x = this.x - w/2, y = this.y - h/2;\n  o.Update(x, y, w, h, this.sc, this.z, xoff, yoff);\n  return o;\n};\nTproto.CheckActive = function(c,xoff,yoff) {\n  var t = this.tc, o = this.UpdateActive(c, xoff, yoff);\n  return o.Active(c, t.mx, t.my) ? o : null;\n};\nTproto.Clicked = function(e) {\n  var a = this.a, t = a.target, h = a.href, evt;\n  if(t != '' && t != '_self') {\n    if(self.frames[t]) {\n      self.frames[t].document.location = h;\n    } else{\n      try {\n        if(top.frames[t]) {\n          top.frames[t].document.location = h;\n          return;\n        }\n      } catch(err) {\n        // different domain/port/protocol?\n      }\n      window.open(h, t);\n    }\n    return;\n  }\n  if(doc.createEvent) {\n    evt = doc.createEvent('MouseEvents');\n    evt.initMouseEvent('click', 1, 1, window, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, null);\n    if(!a.dispatchEvent(evt))\n      return;\n  } else if(a.fireEvent) {\n    if(!a.fireEvent('onclick'))\n      return;\n  }\n  doc.location = h;\n};\n/**\n * @constructor\n */\nfunction TagCanvas(cid,lctr,opt) {\n  var i, p, c = doc.getElementById(cid), cp = ['id','class','innerHTML'], raf;\n\n  if(!c) throw 0;\n  if(Defined(window.G_vmlCanvasManager)) {\n    c = window.G_vmlCanvasManager.initElement(c);\n    this.ie = parseFloat(navigator.appVersion.split('MSIE')[1]);\n  }\n  if(c && (!c.getContext || !c.getContext('2d').fillText)) {\n    p = doc.createElement('DIV');\n    for(i = 0; i < cp.length; ++i)\n      p[cp[i]] = c[cp[i]];\n    c.parentNode.insertBefore(p,c);\n    c.parentNode.removeChild(c);\n    throw 0;\n  }\n  for(i in TagCanvas.options)\n    this[i] = opt && Defined(opt[i]) ? opt[i] : \n      (Defined(TagCanvas[i]) ? TagCanvas[i] : TagCanvas.options[i]);\n\n  this.canvas = c;\n  this.ctxt = c.getContext('2d');\n  this.z1 = 250 / max(this.depth, 0.001);\n  this.z2 = this.z1 / this.zoom;\n  this.radius = min(c.height, c.width) * 0.0075; // fits radius of 100 in canvas\n  this.max_radius = 100;\n  this.max_weight = [];\n  this.min_weight = [];\n  this.textFont = this.textFont && FixFont(this.textFont);\n  this.textHeight *= 1;\n  this.pulsateTo = Clamp(this.pulsateTo, 0, 1);\n  this.minBrightness = Clamp(this.minBrightness, 0, 1);\n  this.maxBrightness = Clamp(this.maxBrightness, this.minBrightness, 1);\n  this.ctxt.textBaseline = 'top';\n  this.lx = (this.lock + '').indexOf('x') + 1;\n  this.ly = (this.lock + '').indexOf('y') + 1;\n  this.frozen = this.dx = this.dy = this.fixedAnim = this.touchState = 0;\n  this.fixedAlpha = 1;\n  this.source = lctr || cid;\n  this.repeatTags = min(64, ~~this.repeatTags);\n  this.minTags = min(200, ~~this.minTags);\n  if(this.minTags > 0 && this.repeatTags < 1 && (i = this.GetTags().length))\n    this.repeatTags = ceil(this.minTags / i) - 1;\n  this.transform = Matrix.Identity();\n  this.startTime = this.time = TimeNow();\n  this.mx = this.my = -1;\n  this.centreImage && CentreImage(this);\n  this.Animate = this.dragControl ? this.AnimateDrag : this.AnimatePosition;\n  this.animTiming = (typeof TagCanvas[this.animTiming] == 'function' ?\n    TagCanvas[this.animTiming] : TagCanvas.Smooth);\n  if(this.shadowBlur || this.shadowOffset[0] || this.shadowOffset[1]) {\n    // let the browser translate \"red\" into \"#ff0000\"\n    this.ctxt.shadowColor = this.shadow;\n    this.shadow = this.ctxt.shadowColor;\n    this.shadowAlpha = ShadowAlphaBroken();\n  } else {\n    delete this.shadow;\n  }\n  this.Load();\n  if(lctr && this.hideTags) {\n    (function(t) {\n    if(TagCanvas.loaded)\n      t.HideTags();\n    else\n      AddHandler('load', function() { t.HideTags(); }, window);\n    })(this);\n  }\n\n  this.yaw = this.initial ? this.initial[0] * this.maxSpeed : 0;\n  this.pitch = this.initial ? this.initial[1] * this.maxSpeed : 0;\n  if(this.tooltip) {\n    this.ctitle = c.title;\n    c.title = '';\n    if(this.tooltip == 'native') {\n      this.Tooltip = this.TooltipNative;\n    } else {\n      this.Tooltip = this.TooltipDiv;\n      if(!this.ttdiv) {\n        this.ttdiv = doc.createElement('div');\n        this.ttdiv.className = this.tooltipClass;\n        this.ttdiv.style.position = 'absolute';\n        this.ttdiv.style.zIndex = c.style.zIndex + 1;\n        AddHandler('mouseover',function(e){e.target.style.display='none';},this.ttdiv);\n        doc.body.appendChild(this.ttdiv);\n      }\n    }\n  } else {\n    this.Tooltip = this.TooltipNone;\n  }\n  if(!this.noMouse && !handlers[cid]) {\n    handlers[cid] = [\n      ['mousemove', MouseMove],\n      ['mouseout', MouseOut],\n      ['mouseup', MouseUp],\n      ['touchstart', TouchDown],\n      ['touchend', TouchUp],\n      ['touchcancel', TouchUp],\n      ['touchmove', TouchMove]\n    ];\n    if(this.dragControl) {\n      handlers[cid].push(['mousedown', MouseDown]);\n      handlers[cid].push(['selectstart', Nop]);\n    }\n    if(this.wheelZoom) {\n      handlers[cid].push(['mousewheel', MouseWheel]);\n      handlers[cid].push(['DOMMouseScroll', MouseWheel]);\n    }\n    for(i = 0; i < handlers[cid].length; ++i)\n      AddHandler(handlers[cid][i][0], handlers[cid][i][1], c);\n  }\n  if(!TagCanvas.started) {\n    raf = window.requestAnimationFrame = window.requestAnimationFrame ||\n      window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame ||\n      window.msRequestAnimationFrame;\n    TagCanvas.NextFrame = raf ? TagCanvas.NextFrameRAF :\n      TagCanvas.NextFrameTimeout;\n    TagCanvas.interval = this.interval;\n    TagCanvas.NextFrame(this.interval);\n    TagCanvas.started = 1;\n  }\n}\nTCproto = TagCanvas.prototype;\nTCproto.SourceElements = function() {\n  if(doc.querySelectorAll)\n    return doc.querySelectorAll('#' + this.source);\n  return [doc.getElementById(this.source)];\n};\nTCproto.HideTags = function() {\n  var el = this.SourceElements(), i;\n  for(i = 0; i < el.length; ++i)\n    el[i].style.display = 'none';\n};\nTCproto.GetTags = function() {\n  var el = this.SourceElements(), etl, tl = [], i, j, k;\n  for(k = 0; k <= this.repeatTags; ++k) {\n    for(i = 0; i < el.length; ++i) {\n      etl = el[i].getElementsByTagName('a');\n      for(j = 0; j < etl.length; ++j) {\n        tl.push(etl[j]);\n      }\n    }\n  }\n  return tl;\n};\nTCproto.Message = function(text) {\n  var tl = [], i, p, tc = text.split(''), a, t, x, z;\n  for(i = 0; i < tc.length; ++i) {\n    if(tc[i] != ' ') {\n      p = i - tc.length / 2;\n      a = doc.createElement('A');\n      a.href = '#';\n      a.innerText = tc[i];\n      x = 100 * sin(p / 9);\n      z = -100 * cos(p / 9);\n      t = new Tag(this, tc[i], a, [x,0,z], 2, 18, '#000', '#fff', 0, 0, 0,\n        'monospace', 2, tc[i]);\n      t.Init();\n      tl.push(t);\n    }\n  }\n  return tl;\n};\nTCproto.CreateTag = function(e) {\n  var im, i, t, txt, ts, font, bc, boc, p = [0, 0, 0];\n  if('text' != this.imageMode) {\n    im = e.getElementsByTagName('img');\n    if(im.length) {\n      i = new Image;\n      i.src = im[0].src;\n\n      if(!this.imageMode) {\n        t = new Tag(this, \"\", e, p, 0, 0);\n        t.SetImage(i);\n        //t.Init();\n        AddImage(i, im[0], t, this);\n        return t;\n      }\n    }\n  }\n  if('image' != this.imageMode) {\n    ts = new TextSplitter(e);\n    txt = ts.Lines();\n    if(!ts.Empty()) {\n      font = this.textFont || FixFont(GetProperty(e,'font-family'));\n      if(this.splitWidth)\n        txt = ts.SplitWidth(this.splitWidth, this.ctxt, font, this.textHeight);\n\n      bc = this.bgColour == 'tag' ? GetProperty(e, 'background-color') :\n        this.bgColour;\n      boc = this.bgOutline == 'tag' ? GetProperty(e, 'color') : this.bgOutline;\n    } else {\n      ts = null;\n    }\n  }\n  if(ts || i) {\n    t = new Tag(this, txt, e, p, 2, this.textHeight + 2,\n      this.textColour || GetProperty(e,'color'), bc, this.bgRadius,\n      boc, this.bgOutlineThickness, font, this.padding, ts && ts.original);\n    if(i) {\n      t.SetImage(i);\n      AddImage(i, im[0], t, this);\n    } else {\n      t.Init();\n    }\n    return t;\n  }\n};\nTCproto.UpdateTag = function(t, a) {\n  var colour = this.textColour || GetProperty(a, 'color'),\n    font = this.textFont || FixFont(GetProperty(a, 'font-family')),\n    bc = this.bgColour == 'tag' ? GetProperty(a, 'background-color') :\n      this.bgColour, boc = this.bgOutline == 'tag' ? GetProperty(a, 'color') :\n      this.bgOutline;\n  t.a = a;\n  t.title = a.title;\n  if(t.colour != colour || t.textFont != font || t.bgColour != bc ||\n    t.bgOutline != boc)\n    t.SetFont(font, colour, bc, boc);\n};\nTCproto.Weight = function(tl) {\n  var ll = tl.length, w, i, s, weights = [], valid,\n    wfrom = this.weightFrom ? this.weightFrom.split(/[, ]/) : [null],\n    wl = wfrom.length;\n  for(i = 0; i < ll; ++i) {\n    weights[i] = [];\n    for(s = 0; s < wl; ++s) {\n      w = FindWeight(tl[i].a, wfrom[s], this.textHeight);\n      if(!this.max_weight[s] || w > this.max_weight[s])\n        this.max_weight[s] = w;\n      if(!this.min_weight[s] || w < this.min_weight[s])\n        this.min_weight[s] = w;\n      weights[i][s] = w;\n    }\n  }\n  for(s = 0; s < wl; ++s) {\n    if(this.max_weight[s] > this.min_weight[s])\n      valid = 1;\n  }\n  if(valid) {\n    for(i = 0; i < ll; ++i) {\n      tl[i].SetWeight(weights[i]);\n    }\n  }\n};\nTCproto.Load = function() {\n  var tl = this.GetTags(), taglist = [], shape, t,\n    shapeArgs, rx, ry, rz, vl, i, tagmap = [], pfuncs = {\n      sphere: PointsOnSphere,\n      vcylinder: PointsOnCylinderV,\n      hcylinder: PointsOnCylinderH,\n      vring: PointsOnRingV,\n      hring: PointsOnRingH\n    };\n\n  if(tl.length) {\n    tagmap.length = tl.length;\n    for(i = 0; i < tl.length; ++i)\n      tagmap[i] = i;\n    this.shuffleTags && Shuffle(tagmap);\n    rx = 100 * this.radiusX;\n    ry = 100 * this.radiusY;\n    rz = 100 * this.radiusZ;\n    this.max_radius = max(rx, max(ry, rz));\n\n    for(i = 0; i < tl.length; ++i) {\n      t = this.CreateTag(tl[tagmap[i]]);\n      if(t)\n        taglist.push(t);\n    }\n    this.weight && this.Weight(taglist, true);\n  \n    if(this.shapeArgs) {\n      this.shapeArgs[0] = taglist.length;\n    } else {\n      shapeArgs = this.shape.toString().split(/[(),]/);\n      shape = shapeArgs.shift();\n      if(typeof window[shape] === 'function')\n        this.shape = window[shape];\n      else\n        this.shape = pfuncs[shape] || pfuncs.sphere;\n      this.shapeArgs = [taglist.length, rx, ry, rz].concat(shapeArgs);\n    }\n    vl = this.shape.apply(this, this.shapeArgs);\n    this.listLength = taglist.length;\n    for(i = 0; i < taglist.length; ++i)\n      taglist[i].position = new Vector(vl[i][0], vl[i][1], vl[i][2]);\n  }\n  if(this.noTagsMessage && !taglist.length)\n    taglist = this.Message('No tags');\n  this.taglist = taglist;\n};\nTCproto.Update = function() {\n  var tl = this.GetTags(), newlist = [],\n    taglist = this.taglist, found,\n    added = [], removed = [], vl, ol, nl, i, j;\n\n  if(!this.shapeArgs)\n    return this.Load();\n\n  if(tl.length) {\n    nl = this.listLength = tl.length;\n    ol = taglist.length;\n\n    // copy existing list, populate \"removed\"\n    for(i = 0; i < ol; ++i) {\n      newlist.push(taglist[i]);\n      removed.push(i);\n    }\n\n    // find added and removed tags\n    for(i = 0; i < nl; ++i) {\n      for(j = 0, found = 0; j < ol; ++j) {\n        if(taglist[j].EqualTo(tl[i])) {\n          this.UpdateTag(newlist[j], tl[i]);\n          found = removed[j] = -1;\n        }\n      }\n      if(!found)\n        added.push(i);\n    }\n\n    // clean out found tags from removed list\n    for(i = 0, j = 0; i < ol; ++i) {\n      if(removed[j] == -1)\n        removed.splice(j,1);\n      else\n        ++j;\n    }\n\n    // insert new tags in gaps where old tags removed\n    if(removed.length) {\n      Shuffle(removed);\n      while(removed.length && added.length) {\n        i = removed.shift();\n        j = added.shift();\n        newlist[i] = this.CreateTag(tl[j]);\n      }\n\n      // remove any more (in reverse order)\n      removed.sort(function(a,b) {return a-b});\n      while(removed.length) {\n        newlist.splice(removed.pop(), 1);\n      }\n    }\n\n    // add any extra tags\n    j = newlist.length / (added.length + 1);\n    i = 0;\n    while(added.length) {\n      newlist.splice(ceil(++i * j), 0, this.CreateTag(tl[added.shift()]));\n    }\n\n    // assign correct positions to tags\n    this.shapeArgs[0] = nl = newlist.length;\n    vl = this.shape.apply(this, this.shapeArgs);\n    for(i = 0; i < nl; ++i)\n      newlist[i].position = new Vector(vl[i][0], vl[i][1], vl[i][2]);\n\n    // reweight tags\n    this.weight && this.Weight(newlist);\n  }\n  this.taglist = newlist;\n};\nTCproto.SetShadow = function(c) {\n  c.shadowBlur = this.shadowBlur;\n  c.shadowOffsetX = this.shadowOffset[0];\n  c.shadowOffsetY = this.shadowOffset[1];\n};\nTCproto.Draw = function(t) {\n  if(this.paused)\n    return;\n  var cv = this.canvas, cw = cv.width, ch = cv.height, max_sc = 0,\n    tdelta = (t - this.time) * TagCanvas.interval / 1000,\n    x = cw / 2 + this.offsetX, y = ch / 2 + this.offsetY, c = this.ctxt,\n    active, a, i, aindex = -1, tl = this.taglist, l = tl.length,\n    frontsel = this.frontSelect, centreDrawn = (this.centreFunc == Nop), fixed;\n  this.time = t;\n  if(this.frozen && this.drawn)\n    return this.Animate(cw,ch,tdelta);\n  fixed = this.AnimateFixed();\n  c.setTransform(1,0,0,1,0,0);\n  for(i = 0; i < l; ++i)\n    tl[i].Calc(this.transform, this.fixedAlpha);\n  tl = SortList(tl, function(a,b) {return b.z-a.z});\n  \n  if(fixed && this.fixedAnim.active) {\n    active = this.fixedAnim.tag.UpdateActive(c, x, y);\n  } else {\n    this.active = null;\n    for(i = 0; i < l; ++i) {\n      a = this.mx >= 0 && this.my >= 0 && this.taglist[i].CheckActive(c, x, y);\n      if(a && a.sc > max_sc && (!frontsel || a.z <= 0)) {\n        active = a;\n        aindex = i;\n        active.tag = this.taglist[i];\n        max_sc = a.sc;\n      }\n    }\n    this.active = active;\n  }\n\n  this.txtOpt || (this.shadow && this.SetShadow(c));\n  c.clearRect(0,0,cw,ch);\n  for(i = 0; i < l; ++i) {\n    if(!centreDrawn && tl[i].z <= 0) {\n      // run the centreFunc if the next tag is at the front\n      try { this.centreFunc(c, cw, ch, x, y); }\n      catch(e) {\n        alert(e);\n        // don't run it again\n        this.centreFunc = Nop;\n      }\n      centreDrawn = true;\n    }\n\n    if(!(active && active.tag == tl[i] && active.PreDraw(c, tl[i], x, y)))\n      tl[i].Draw(c, x, y);\n    active && active.tag == tl[i] && active.PostDraw(c);\n  }\n  if(this.freezeActive && active) {\n    this.Freeze();\n  } else {\n    this.UnFreeze();\n    this.drawn = (l == this.listLength);\n  }\n  if(this.fixedCallback) {\n    this.fixedCallback(this,this.fixedCallbackTag);\n    this.fixedCallback = null;\n  }\n  fixed || this.Animate(cw, ch, tdelta);\n  active && active.LastDraw(c);\n  cv.style.cursor = active ? this.activeCursor : '';\n  this.Tooltip(active,this.taglist[aindex]);\n};\nTCproto.TooltipNone = function() { };\nTCproto.TooltipNative = function(active,tag) {\n  if(active)\n    this.canvas.title = tag && tag.title ? tag.title : '';\n  else\n    this.canvas.title = this.ctitle;\n};\nTCproto.SetTTDiv = function(title, tag) {\n  var tc = this, s = tc.ttdiv.style;\n  if(title != tc.ttdiv.innerHTML)\n    s.display = 'none';\n  tc.ttdiv.innerHTML = title;\n  tag && (tag.title = tc.ttdiv.innerHTML);\n  if(s.display == 'none' && ! tc.tttimer) {\n    tc.tttimer = setTimeout(function() {\n      var p = AbsPos(tc.canvas.id);\n      s.display = 'block';\n      s.left = p.x + tc.mx + 'px';\n      s.top = p.y + tc.my + 24 + 'px';\n      tc.tttimer = null;\n    }, tc.tooltipDelay);\n  }\n};\nTCproto.TooltipDiv = function(active,tag) {\n  if(active && tag && tag.title) {\n    this.SetTTDiv(tag.title, tag);\n  } else if(!active && this.mx != -1 && this.my != -1 && this.ctitle.length) {\n    this.SetTTDiv(this.ctitle);\n  } else {\n    this.ttdiv.style.display = 'none';\n  }\n};\nTCproto.Transform = function(tc, p, y) {\n  if(p || y) {\n    var sp = sin(p), cp = cos(p), sy = sin(y), cy = cos(y),\n      ym = new Matrix([cy,0,sy, 0,1,0, -sy,0,cy]),\n      pm = new Matrix([1,0,0, 0,cp,-sp, 0,sp,cp]);\n    tc.transform = tc.transform.mul(ym.mul(pm));\n  }\n};\nTCproto.AnimateFixed = function() {\n  var fa, t1, angle, m, d;\n  if(this.fadeIn) {\n    t1 = TimeNow() - this.startTime;\n    if(t1 >= this.fadeIn) {\n      this.fadeIn = 0;\n      this.fixedAlpha = 1;\n    } else {\n      this.fixedAlpha = t1 / this.fadeIn;\n    }\n  }\n  if(this.fixedAnim) {\n    if(!this.fixedAnim.transform)\n      this.fixedAnim.transform = this.transform;\n    fa = this.fixedAnim, t1 = TimeNow() - fa.t0, angle = fa.angle,\n      m, d = this.animTiming(fa.t, t1);\n    this.transform = fa.transform;\n    if(t1 >= fa.t) {\n      this.fixedCallbackTag = fa.tag;\n      this.fixedCallback = fa.cb;\n      this.fixedAnim = this.yaw = this.pitch = 0;\n    } else {\n      angle *= d;\n    }\n    m = Matrix.Rotation(angle, fa.axis);\n    this.transform = this.transform.mul(m);\n    return (this.fixedAnim != 0);\n  }\n  return false;\n};\nTCproto.AnimatePosition = function(w, h, t) {\n  var tc = this, x = tc.mx, y = tc.my, s, r;\n  if(!tc.frozen && x >= 0 && y >= 0 && x < w && y < h) {\n    s = tc.maxSpeed, r = tc.reverse ? -1 : 1;\n    tc.lx || (tc.yaw = ((x * 2 * s / w) - s) * r * t);\n    tc.ly || (tc.pitch = ((y * 2 * s / h) - s) * -r * t);\n    tc.initial = null;\n  } else if(!tc.initial) {\n    if(tc.frozen && !tc.freezeDecel)\n      tc.yaw = tc.pitch = 0;\n    else\n      tc.Decel(tc);\n  }\n  this.Transform(tc, tc.pitch, tc.yaw);\n};\nTCproto.AnimateDrag = function(w, h, t) {\n  var tc = this, rs = 100 * t * tc.maxSpeed / tc.max_radius / tc.zoom;\n  if(tc.dx || tc.dy) {\n    tc.lx || (tc.yaw = tc.dx * rs / tc.stretchX);\n    tc.ly || (tc.pitch = tc.dy * -rs / tc.stretchY);\n    tc.dx = tc.dy = 0;\n    tc.initial = null;\n  } else if(!tc.initial) {\n    tc.Decel(tc);\n  }\n  this.Transform(tc, tc.pitch, tc.yaw);\n};\nTCproto.Freeze = function() {\n  if(!this.frozen) {\n    this.preFreeze = [this.yaw, this.pitch];\n    this.frozen = 1;\n    this.drawn = 0;\n  }\n};\nTCproto.UnFreeze = function() {\n  if(this.frozen) {\n    this.yaw = this.preFreeze[0];\n    this.pitch = this.preFreeze[1];\n    this.frozen = 0;\n  }\n};\nTCproto.Decel = function(tc) {\n  var s = tc.minSpeed, ay = abs(tc.yaw), ap = abs(tc.pitch);\n  if(!tc.lx && ay > s)\n    tc.yaw = ay > tc.z0 ? tc.yaw * tc.decel : 0;\n  if(!tc.ly && ap > s)\n    tc.pitch = ap > tc.z0 ? tc.pitch * tc.decel : 0;\n};\nTCproto.Zoom = function(r) {\n  this.z2 = this.z1 * (1/r);\n  this.drawn = 0;\n};\nTCproto.Clicked = function(e) {\n  var a = this.active;\n  try {\n    if(a && a.tag)\n      if(this.clickToFront === false || this.clickToFront === null)\n        a.tag.Clicked(e);\n      else\n        this.TagToFront(a.tag, this.clickToFront, function() {\n          a.tag.Clicked(e);\n        }, true);\n  } catch(ex) {\n  }\n};\nTCproto.Wheel = function(i) {\n  var z = this.zoom + this.zoomStep * (i ? 1 : -1);\n  this.zoom = min(this.zoomMax,max(this.zoomMin,z));\n  this.Zoom(this.zoom);\n};\nTCproto.BeginDrag = function(e) {\n  this.down = EventXY(e, this.canvas);\n  e.cancelBubble = true;\n  e.returnValue = false;\n  e.preventDefault && e.preventDefault();\n};\nTCproto.Drag = function(e, p) {\n  if(this.dragControl && this.down) {\n    var t2 = this.dragThreshold * this.dragThreshold,\n      dx = p.x - this.down.x, dy = p.y - this.down.y;\n    if(this.dragging || dx * dx + dy * dy > t2) {\n      this.dx = dx;\n      this.dy = dy;\n      this.dragging = 1;\n      this.down = p;\n    }\n  }\n  return this.dragging;\n};\nTCproto.EndDrag = function() {\n  var res = this.dragging;\n  this.dragging = this.down = null;\n  return res;\n};\nfunction PinchDistance(e) {\n  var t1 = e.targetTouches[0], t2 = e.targetTouches[1];\n  return sqrt(pow(t2.pageX - t1.pageX, 2) + pow(t2.pageY - t1.pageY, 2));\n}\nTCproto.BeginPinch = function(e) {\n  this.pinched = [PinchDistance(e), this.zoom];\n  e.preventDefault && e.preventDefault();\n};\nTCproto.Pinch = function(e) {\n  var z, d, p = this.pinched;\n  if(!p)\n    return;\n  d = PinchDistance(e);\n  z = p[1] * d / p[0];\n  this.zoom = min(this.zoomMax,max(this.zoomMin,z));\n  this.Zoom(this.zoom);\n};\nTCproto.EndPinch = function(e) {\n  this.pinched = null;\n};\nTCproto.Pause = function() { this.paused = true; };\nTCproto.Resume = function() { this.paused = false; };\nTCproto.SetSpeed = function(i) {\n  this.initial = i;\n  this.yaw = i[0] * this.maxSpeed;\n  this.pitch = i[1] * this.maxSpeed;\n};\nTCproto.FindTag = function(t) {\n  if(!Defined(t))\n    return null;\n  Defined(t.index) && (t = t.index);\n  if(!IsObject(t))\n    return this.taglist[t];\n  var srch, tgt, i;\n  if(Defined(t.id))\n    srch = 'id', tgt = t.id;\n  else if(Defined(t.text))\n    srch = 'innerText', tgt = t.text;\n\n  for(i = 0; i < this.taglist.length; ++i)\n    if(this.taglist[i].a[srch] == tgt)\n      return this.taglist[i];\n};\nTCproto.RotateTag = function(tag, lt, lg, time, callback, active) {\n  var t = tag.xformed, v1 = new Vector(t.x, t.y, t.z),\n    v2 = MakeVector(lg, lt), angle = v1.angle(v2), u = v1.cross(v2).unit();\n  if(angle == 0) {\n    this.fixedCallbackTag = tag;\n    this.fixedCallback = callback;\n  } else {\n    this.fixedAnim = {\n      angle: -angle,\n      axis: u,\n      t: time,\n      t0: TimeNow(),\n      cb: callback,\n      tag: tag,\n      active: active\n    };\n  }\n};\nTCproto.TagToFront = function(tag, time, callback, active) {\n  this.RotateTag(tag, 0, 0, time, callback, active);\n};\nTagCanvas.Start = function(id,l,o) {\n  TagCanvas.Delete(id);\n  TagCanvas.tc[id] = new TagCanvas(id,l,o);\n};\nfunction tccall(f,id) {\n  TagCanvas.tc[id] && TagCanvas.tc[id][f]();\n}\nTagCanvas.Linear = function(t, t0) { return t0 / t; }\nTagCanvas.Smooth = function(t, t0) { return 0.5 - cos(t0 * Math.PI / t) / 2; }\nTagCanvas.Pause = function(id) { tccall('Pause',id); };\nTagCanvas.Resume = function(id) { tccall('Resume',id); };\nTagCanvas.Reload = function(id) { tccall('Load',id); };\nTagCanvas.Update = function(id) { tccall('Update',id); };\nTagCanvas.SetSpeed = function(id, speed) {\n  if(IsObject(speed) && TagCanvas.tc[id] &&\n    !isNaN(speed[0]) && !isNaN(speed[1])) {\n    TagCanvas.tc[id].SetSpeed(speed);\n    return true;\n  }\n  return false;\n};\nTagCanvas.TagToFront = function(id, options) {\n  if(!IsObject(options))\n    return false;\n  options.lat = options.lng = 0;\n  return TagCanvas.RotateTag(id, options);\n};\nTagCanvas.RotateTag = function(id, options) {\n  if(IsObject(options) && TagCanvas.tc[id]) {\n    if(isNaN(options.time))\n      options.time = 500;\n    var tt = TagCanvas.tc[id].FindTag(options);\n    if(tt) {\n      TagCanvas.tc[id].RotateTag(tt, options.lat, options.lng,\n        options.time, options.callback, options.active);\n      return true;\n    }\n  }\n  return false;\n};\nTagCanvas.Delete = function(id) {\n  var i, c;\n  if(handlers[id]) {\n    c = doc.getElementById(id);\n    if(c) {\n      for(i = 0; i < handlers[id].length; ++i)\n        RemoveHandler(handlers[id][i][0], handlers[id][i][1], c);\n    }\n  }\n  delete handlers[id];\n  delete TagCanvas.tc[id];\n};\nTagCanvas.NextFrameRAF = function() {\n  requestAnimationFrame(DrawCanvasRAF);\n};\nTagCanvas.NextFrameTimeout = function(iv) {\n  setTimeout(DrawCanvas, iv);\n};\nTagCanvas.tc = {};\nTagCanvas.options = {\nz1: 20000,\nz2: 20000,\nz0: 0.0002,\nfreezeActive: false,\nfreezeDecel: false,\nactiveCursor: 'pointer',\npulsateTo: 1,\npulsateTime: 3,\nreverse: false,\ndepth: 0.5,\nmaxSpeed: 0.05,\nminSpeed: 0,\ndecel: 0.95,\ninterval: 20,\nminBrightness: 0.1,\nmaxBrightness: 1,\noutlineColour: '#ffff99',\noutlineThickness: 2,\noutlineOffset: 5,\noutlineMethod: 'outline',\noutlineRadius: 0,\ntextColour: '#ff99ff',\ntextHeight: 15,\ntextFont: 'Helvetica, Arial, sans-serif',\nshadow: '#000',\nshadowBlur: 0,\nshadowOffset: [0,0],\ninitial: null,\nhideTags: true,\nzoom: 1,\nweight: false,\nweightMode: 'size',\nweightFrom: null,\nweightSize: 1,\nweightSizeMin: null,\nweightSizeMax: null,\nweightGradient: {0:'#f00', 0.33:'#ff0', 0.66:'#0f0', 1:'#00f'},\ntxtOpt: true,\ntxtScale: 2,\nfrontSelect: false,\nwheelZoom: true,\nzoomMin: 0.3,\nzoomMax: 3,\nzoomStep: 0.05,\nshape: 'sphere',\nlock: null,\ntooltip: null,\ntooltipDelay: 300,\ntooltipClass: 'tctooltip',\nradiusX: 1,\nradiusY: 1,\nradiusZ: 1,\nstretchX: 1,\nstretchY: 1,\noffsetX: 0,\noffsetY: 0,\nshuffleTags: false,\nnoSelect: false,\nnoMouse: false,\nimageScale: 1,\npaused: false,\ndragControl: false,\ndragThreshold: 4,\ncentreFunc: Nop,\nsplitWidth: 0,\nanimTiming: 'Smooth',\nclickToFront: false,\nfadeIn: 0,\npadding: 0,\nbgColour: null,\nbgRadius: 0,\nbgOutline: null,\nbgOutlineThickness: 0,\noutlineIncrease: 4,\ntextAlign: 'centre',\ntextVAlign: 'middle',\nimageMode: null,\nimagePosition: null,\nimagePadding: 2,\nimageAlign: 'centre',\nimageVAlign: 'middle',\nnoTagsMessage: true,\ncentreImage: null,\npinchZoom: false,\nrepeatTags: 0,\nminTags: 0\n};\nfor(i in TagCanvas.options) TagCanvas[i] = TagCanvas.options[i];\nwindow.TagCanvas = TagCanvas;\n// set a flag for when the window has loaded\nAddHandler('load',function(){TagCanvas.loaded=1},window);\n})();\n"]}